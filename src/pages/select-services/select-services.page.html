<app-custom-header
  title="SELECIONE OS SERVIÇOS"
  [showStartButton]="true"
  (onStartClick)="getBack()"
  RouterLink="/select-professional"
  [endDisabled]="selectedServices.length === 0"
  startIconName="close-outline"
  [showEndButton]="true"
  endIconName="checkmark-done"  
  (onEndClick)="confirmSelection()"
></app-custom-header>

<ion-content class="ion-padding">  
  <ion-card class="service-card">
    <ion-card-header  class="compact-header">
      <ion-card-title class="card-title">SERVIÇOS DISPONÍVEIS</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div class="scroll-container">
        <ion-list class="service-list">
          <ion-item
            *ngFor="let service of serviceOptions"
            (click)="addService(service)"
            button
            detail="false"
            class="service-item"
          >
            <div slot="start" class="service-image-container">
              <img
                *ngIf="service.category.imgPath"
                [src]="service.category.imgPath"
                class="service-image"
                alt=""
              />
              <ion-icon
                *ngIf="!service.category.imgPath"
                name="cut-outline"
                class="service-icon"
              ></ion-icon>
            </div>

            <ion-label class="service-info">
              <h3>{{ service.name }}</h3>
              <p class="service-meta">
                <span
                  ><ion-icon name="time-outline"></ion-icon> {{ service.duration }}
                  min</span
                >
                <span
                  ><ion-icon name="cash-outline"></ion-icon> R$ {{ service.price
                  | number:'1.2-2' }}</span
                >
              </p>
            </ion-label>
            <ion-icon
              name="add-circle-outline"
              color="primary"
              slot="end"
            ></ion-icon>
          </ion-item>
        </ion-list>
      </div>
    </ion-card-content>
  </ion-card>

  <ion-card class="selected-card">
    <ion-card-header>
      <ion-card-title class="card-title">SERVIÇOS SELECIONADOS</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div class="selected-chips">
        <ion-chip
          *ngFor="let selected of selectedServices; let i = index"
          color="primary"
          outline
          class="service-chip"
        >
          <div class="chip-image-container" *ngIf="selected.imgPath">
            <img [src]="selected.imgPath" class="chip-image" alt="" />
          </div>
          <ion-label>
            {{ selected.name }}
            <span *ngIf="selected.quantity > 1" class="quantity-badge"
              >{{ selected.quantity }}</span
            >
          </ion-label>
          <ion-icon
            name="remove-circle"
            (click)="removeService(i)"
            color="danger"
          ></ion-icon>
        </ion-chip>
      </div>
    </ion-card-content>
  </ion-card>

  <ion-item class="notes-item">
    <ion-label position="floating">Observações</ion-label>
    <ion-textarea
      [(ngModel)]="notes"
      name="observacao"
      rows="3"
      maxlength="33"
      autoGrow="true"
      placeholder="Alguma observação especial sobre os serviços..."
    ></ion-textarea>
  </ion-item>

  <ion-card class="payment-card">
    <ion-card-header>
      <ion-card-title class="card-title">Forma de Pagamento</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <ion-segment
        [(ngModel)]="paymentMethod"
        name="formaPagamento"
        value="1"
        class="payment-segment"
      >
        <ion-segment-button value="1" class="payment-option">
          <ion-icon name="cash-outline"></ion-icon>
          <ion-label>Dinheiro</ion-label>
        </ion-segment-button>
        <ion-segment-button value="3" class="payment-option">
          <ion-icon name="qr-code-outline"></ion-icon>
          <ion-label>Pix</ion-label>
        </ion-segment-button>
        <ion-segment-button value="2" class="payment-option">
          <ion-icon name="card-outline"></ion-icon>
          <ion-label>Cartão</ion-label>
        </ion-segment-button>
      </ion-segment>
    </ion-card-content>
  </ion-card>

  <ion-card class="summary-card">
    <ion-card-content>
      <ion-list lines="none">
        <ion-item>
          <ion-label>Tempo Total:</ion-label>
          <ion-note slot="end">{{ totalTimeString }}</ion-note>
        </ion-item>
        <ion-item>
          <ion-label>Valor Total:</ion-label>
          <ion-note slot="end" color="primary"
            ><strong>{{ totalPriceString }}</strong></ion-note
          >
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>
</ion-content>
